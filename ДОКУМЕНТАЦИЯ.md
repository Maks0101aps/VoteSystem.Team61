# VoteSystem.Team61 - Документация по установке

Данный документ содержит инструкции по установке и запуску приложения VoteSystem.Team61 на операционных системах Linux и Windows.

## Системные требования

### Общие требования
- PHP 8.2 или выше
- Composer
- Node.js (16.x или выше)
- npm
- Git
- База данных (MySQL, PostgreSQL или SQLite)
- PHP расширения: exif, gd

### Требования для Windows
- Windows 10 или выше
- [XAMPP](https://www.apachefriends.org/download.html), [Laragon](https://laragon.org/download/index.html) или [WampServer](https://www.wampserver.com/en/) (рекомендуется для упрощения настройки PHP)
- [Git для Windows](https://gitforwindows.org/)

### Требования для Linux
- Ubuntu 20.04/22.04 или другой современный дистрибутив Linux
- Веб-сервер Apache или Nginx

## Инструкции по установке

### Шаг 1: Клонирование репозитория

**Windows:**
```powershell
git clone <url-репозитория> VoteSystem.Team61
cd VoteSystem.Team61
```

**Linux:**
```bash
git clone <url-репозитория> VoteSystem.Team61
cd VoteSystem.Team61
```

### Шаг 2: Установка PHP зависимостей

**Windows:**
```powershell
composer install
```

**Linux:**
```bash
composer install
```

### Шаг 3: Установка JavaScript зависимостей

**Windows:**
```powershell
npm ci
```

**Linux:**
```bash
npm ci
```

### Шаг 4: Настройка окружения

**Windows:**
```powershell
copy .env.example .env
php artisan key:generate
```

**Linux:**
```bash
cp .env.example .env
php artisan key:generate
```

Отредактируйте файл `.env` для настройки подключения к базе данных:

**SQLite:**
```
DB_CONNECTION=sqlite
DB_DATABASE=/абсолютный/путь/к/базе/database.sqlite
```

**MySQL/PostgreSQL:**
```
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=votesystem
DB_USERNAME=ваш_пользователь
DB_PASSWORD=ваш_пароль
```

### Шаг 5: Настройка базы данных

**SQLite (для Windows и Linux):**

Создание файла базы данных SQLite:

**Windows:**
```powershell
New-Item -ItemType file -Path database/database.sqlite
```

**Linux:**
```bash
touch database/database.sqlite
```

**Выполнение миграций:**

**Windows/Linux:**
```
php artisan migrate
php artisan db:seed
```

### Шаг 6: Сборка ассетов

**Windows/Linux:**
```
npm run dev
```

Для продакшена:
```
npm run build
```

### Шаг 7: Запуск сервера разработки

**Windows/Linux:**
```
php artisan serve
```

Приложение должно быть доступно по адресу http://localhost:8000

## Запуск в production-окружении

### Использование Apache

#### Windows (с XAMPP/WampServer/Laragon)

1. Настройте виртуальный хост, указывающий на директорию `public`
2. Убедитесь, что mod_rewrite включен
3. Убедитесь, что директории storage и bootstrap/cache доступны для записи

#### Linux (Apache)

1. Настройте виртуальный хост:
```apache
<VirtualHost *:80>
    ServerName votesystem.local
    DocumentRoot /путь/к/VoteSystem.Team61/public
    
    <Directory "/путь/к/VoteSystem.Team61/public">
        AllowOverride All
        Require all granted
    </Directory>
    
    ErrorLog ${APACHE_LOG_DIR}/votesystem-error.log
    CustomLog ${APACHE_LOG_DIR}/votesystem-access.log combined
</VirtualHost>
```

2. Активируйте сайт и перезапустите Apache:
```bash
sudo a2ensite votesystem.conf
sudo systemctl restart apache2
```

### Использование Nginx

#### Linux (Nginx)

1. Настройте блок сервера:
```nginx
server {
    listen 80;
    server_name votesystem.local;
    root /путь/к/VoteSystem.Team61/public;

    add_header X-Frame-Options "SAMEORIGIN";
    add_header X-XSS-Protection "1; mode=block";
    add_header X-Content-Type-Options "nosniff";

    index index.php;
    charset utf-8;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location = /favicon.ico { access_log off; log_not_found off; }
    location = /robots.txt  { access_log off; log_not_found off; }

    error_page 404 /index.php;

    location ~ \.php$ {
        fastcgi_pass unix:/var/run/php/php8.2-fpm.sock;
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        include fastcgi_params;
    }

    location ~ /\.(?!well-known).* {
        deny all;
    }
}
```

2. Активируйте сайт и перезапустите Nginx:
```bash
sudo ln -s /etc/nginx/sites-available/votesystem /etc/nginx/sites-enabled/
sudo systemctl restart nginx
```

## Распространенные проблемы и их решение

### Проблемы, специфичные для Windows

1. **Права доступа к файлам**: 
   - Убедитесь, что процесс PHP имеет права на запись в директории `storage` и `bootstrap/cache`
   - Возможно, вам потребуется запускать команды от имени администратора

2. **Проблемы с SSL при использовании Composer**:
   - Если вы сталкиваетесь с ошибками SSL-сертификатов при выполнении команд composer, попробуйте:
   ```powershell
   composer config -g disable-tls true
   ```

3. **Проблемы с путями**:
   - Убедитесь, что PHP, Composer и Node.js добавлены в системную переменную PATH

### Проблемы, специфичные для Linux

1. **Права доступа к файлам**:
   - Установите правильные права доступа для директорий storage и bootstrap/cache:
   ```bash
   sudo chown -R $USER:www-data storage bootstrap/cache
   sudo chmod -R 775 storage bootstrap/cache
   ```

2. **Отсутствующие расширения PHP**:
   - Установите необходимые расширения PHP:
   ```bash
   sudo apt update
   sudo apt install php8.2-common php8.2-cli php8.2-gd php8.2-mysql php8.2-pgsql php8.2-sqlite3 php8.2-xml php8.2-zip php8.2-mbstring php8.2-curl
   ```

## Доступ пользователя

После установки вы можете получить доступ к системе, используя следующие учетные данные по умолчанию:

- **Email:** johndoe@example.com
- **Пароль:** secret

## Дополнительные ресурсы

- [Документация Laravel](https://laravel.com/docs)
- [Документация Inertia.js](https://inertiajs.com/)
- [Документация Vue 3](https://vuejs.org/guide/introduction.html) 